#!/bin/bash -

## Print a header
SCRIPT_NAME="Fixed bugs"
LINE=$(printf "%076s\n" | tr " " "-")
printf "# %s %s\n" "${LINE:${#SCRIPT_NAME}}" "${SCRIPT_NAME}"

## Declare a color code for test results
RED="\033[1;31m"
GREEN="\033[1;32m"
NO_COLOR="\033[0m"

failure () {
    printf "${RED}FAIL${NO_COLOR}: ${1}\n"
    # exit -1
}

success () {
    printf "${GREEN}PASS${NO_COLOR}: ${1}\n"
}

## Is vsearch installed?
VSEARCH=$(which vsearch)
DESCRIPTION="check if vsearch is in the PATH"
[[ "${VSEARCH}" ]] && success "${DESCRIPTION}" || failure "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#                  Improve selection of unique kmers in query                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/1


#******************************************************************************#
#                                                                              #
#                        Parallelisation with pthreads                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/2


#******************************************************************************#
#                                                                              #
#     Vectorization of global alignment - single query vs multiple targets     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/3


#******************************************************************************#
#                                                                              #
#                        Clustering similar to usearch                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/4


#******************************************************************************#
#                                                                              #
#                      Performance comparison to usearch                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/5


#******************************************************************************#
#                                                                              #
#                               Sequence masking                               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/6


#******************************************************************************#
#                                                                              #
#                        Implement more accept options                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/7


#******************************************************************************#
#                                                                              #
#                             Search both strands                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/8


#******************************************************************************#
#                                                                              #
#                 Add support for bzipped/gzipped fasta files                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/9


#******************************************************************************#
#                                                                              #
#                         Prioritized features/options                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/10


#******************************************************************************#
#                                                                              #
#                                  Clustering                                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/11


#******************************************************************************#
#                                                                              #
#                              Chimera detection                               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/12


#******************************************************************************#
#                                                                              #
#                                Documentation                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/13


#******************************************************************************#
#                                                                              #
#                                  Manuscript                                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/14


#******************************************************************************#
#                                                                              #
#                  Support for long (>15 nt) and gapped seeds                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/15


#******************************************************************************#
#                                                                              #
#      Vectorization of global alignment - single query vs single target       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/16


#******************************************************************************#
#                                                                              #
#        Convert array of top kmer hits into a min heap priority queue         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/17


#******************************************************************************#
#                                                                              #
#                        Fix values of some userfields                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/18


#******************************************************************************#
#                                                                              #
#           Add option to define identity as including terminal gaps           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/19


#******************************************************************************#
#                                                                              #
#      Fix number of columns in blast6out output for non-matching queries      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/20


#******************************************************************************#
#                                                                              #
#                Consistency with output_no_hits and uc_allhits                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/21


#******************************************************************************#
#                                                                              #
#                          Segfault in dereplication                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/22


#******************************************************************************#
#                                                                              #
#                     do not wrap alignments when rowlen=0                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/23


#******************************************************************************#
#                                                                              #
#                    fix for maxaccepts=0 and maxrejects=0                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/24


#******************************************************************************#
#                                                                              #
#              Implement --cons_truncate clustering output option              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/25


#******************************************************************************#
#                                                                              #
#                            Minor bug in Makefile                             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/26


#******************************************************************************#
#                                                                              #
#                  Shuffling not random on unix with --seed 0                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/27


#******************************************************************************#
#                                                                              #
#When sorting, the --minsize and --maxsize options don't work (no change in the#
#                                    output)                                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/28


#******************************************************************************#
#                                                                              #
#                    maxuniquesize option for dereplication                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/29


#******************************************************************************#
#                                                                              #
#                                Bug in masking                                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/30


#******************************************************************************#
#                                                                              #
#   Difference between --blast6out and --userout for evalue and bits fields    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/31


#******************************************************************************#
#                                                                              #
# When searching a database against itself, sequence labels are not truncated  #
#                                   correctly                                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/32


#******************************************************************************#
#                                                                              #
#          Difference between --blast6out and --userout for id field           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/33


#******************************************************************************#
#                                                                              #
#           Speed-up searching when using the --top_hits_only option           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/34


#******************************************************************************#
#                                                                              #
#       Should T and U be considered as identical during dereplication?        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/35


#******************************************************************************#
#                                                                              #
#              Support for --sizein and --sizeout when clustering              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/36


#******************************************************************************#
#                                                                              #
#      Check if illegal options are specified for the different commands       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/37


#******************************************************************************#
#                                                                              #
#               Stable sorting to avoid input-order dependencies               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/38


#******************************************************************************#
#                                                                              #
# Support for reading from / writing to pipes (input from stdin and output to  #
#                                    stdout)                                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/39


#******************************************************************************#
#                                                                              #
#                         Automatic regression testing                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/40


#******************************************************************************#
#                                                                              #
#                              Bug in sortbysize                               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/41


#******************************************************************************#
#                                                                              #
#                     Add support for amino acid sequences                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/42


#******************************************************************************#
#                                                                              #
#                                     API                                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/43


#******************************************************************************#
#                                                                              #
#             add usearch's fastq_mergepairs function and options              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/44


#******************************************************************************#
#                                                                              #
#                    Illegal instruction fault on some cpus                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/45


#******************************************************************************#
#                                                                              #
#                            Write --help to stdout                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/46


#******************************************************************************#
#                                                                              #
#                            allpairs_global option                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/47


#******************************************************************************#
#                                                                              #
#                         Reference Chimera checking.                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/48


#******************************************************************************#
#                                                                              #
#             Add --log option to uchime_ref (and other commands?)             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/49


#******************************************************************************#
#                                                                              #
#                              Add --quiet option                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/50


#******************************************************************************#
#                                                                              #
#         Reduce memory requirements for aligning very long sequences          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/51


#******************************************************************************#
#                                                                              #
#                Handle alignments of long sequences correctly                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/52


#******************************************************************************#
#                                                                              #
#     Incorrect output from chimera detection with the --uchimeout option      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/53


#******************************************************************************#
#                                                                              #
#                  blast6out subject and query hit location.                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/54


#******************************************************************************#
#                                                                              #
#                     Option to output in SAM format file                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/55


#******************************************************************************#
#                                                                              #
#                           Documentation - git link                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/56


#******************************************************************************#
#                                                                              #
#     Use "=" to indicate perfect alignment in column 8 of UC output file      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/57


#******************************************************************************#
#                                                                              #
#                      Add a "cluster_abundance" command                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/58


#******************************************************************************#
#                                                                              #
#                     Improve help message for clustering                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/59


#******************************************************************************#
#                                                                              #
#                 Single Makefile, Autotools and smaller repo                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/60


#******************************************************************************#
#                                                                              #
#  cluster_fast should sort by length first, then by abundance and finally by  #
#                              sequence identifier                             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/61


#******************************************************************************#
#                                                                              #
#    Ignore abundance input for clustering and dereplication if sizein not     #
#                                   specified                                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/62


#******************************************************************************#
#                                                                              #
#         Seg Fault or Cannot allocate enough memory on long sequences         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/63


#******************************************************************************#
#                                                                              #
#          Dereplication: option to use hash values as sequence names          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/64


#******************************************************************************#
#                                                                              #
#                          x permissions on binaries                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/65


#******************************************************************************#
#                                                                              #
#       Improve reading of FASTA files, including very long header lines       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/66


#******************************************************************************#
#                                                                              #
#                       Ambiguity in consensus alignment                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/67


#******************************************************************************#
#                                                                              #
#                          adopt semantic versioning                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/68


#******************************************************************************#
#                                                                              #
#   malloc: *** error for object 0x7ff2bad003a0: pointer being freed was not   #
#                                   allocated                                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/69


#******************************************************************************#
#                                                                              #
#               Error in `vsearch': corrupted double-linked list               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/70


#******************************************************************************#
#                                                                              #
#          Error in calculation of the identity using --iddef 3 (MBL)          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/71


#******************************************************************************#
#                                                                              #
#                        Integrate patches from Debian                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/72


#******************************************************************************#
#                                                                              #
#                         Status taxonomy assignment?                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/73


#******************************************************************************#
#                                                                              #
#                  cluster input sequences shorter than 32nt                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/74


#******************************************************************************#
#                                                                              #
#             cluster_fast and msa output for each of the clusters             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/75


#******************************************************************************#
#                                                                              #
#                segfault when running cluster_fast with msaout                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/76


#******************************************************************************#
#                                                                              #
# Segmentation fault when using --uchime_denovo on a large fasta file (9.3 GB) #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/77


#******************************************************************************#
#                                                                              #
#                     Chimera detection progress indicator                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/78


#******************************************************************************#
#                                                                              #
#                        Support for multiple databases                        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/79


#******************************************************************************#
#                                                                              #
#                           Generating cluster files                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/80


#******************************************************************************#
#                                                                              #
#                            Space in a header line                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/81


#******************************************************************************#
#                                                                              #
#       Error "No output files specified" when only samout is specified        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/82


#******************************************************************************#
#                                                                              #
#               Wanted: samout with search, not just clustering                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/83


#******************************************************************************#
#                                                                              #
#                     --relabel does not work consistently                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/84


#******************************************************************************#
#                                                                              #
#                Problem with repeats when clustering WGS reads                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/85


#******************************************************************************#
#                                                                              #
#         Option to not ignore terminal gaps when computing consensus          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/86


#******************************************************************************#
#                                                                              #
#              Chimera search with translated protein sequences?               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/87


#******************************************************************************#
#                                                                              #
#                        Vsearch needs a Galaxy wrapper                        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/88


#******************************************************************************#
#                                                                              #
#        Consensus output in clustering produces empty fasta sequences         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/89


#******************************************************************************#
#                                                                              #
#                 Dereplication based on prefixes of sequences                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/90


#******************************************************************************#
#                                                                              #
#                       Unable to build on OS X 10.10.3                        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/91


#******************************************************************************#
#                                                                              #
#                    MAINT: renaming string.h to xstring.h                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/92


#******************************************************************************#
#                                                                              #
#                   I've made a homebrew package for vsearch                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/93


#******************************************************************************#
#                                                                              #
#                         Sequence profile of clusters                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/94


#******************************************************************************#
#                                                                              #
#             usearch_global sequences that contain repeated kmers             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/95


#******************************************************************************#
#                                                                              #
#                  question about compile time optimizations                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/96


#******************************************************************************#
#                                                                              #
#                Error in `vsearch': double free or corruption                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/97


#******************************************************************************#
#                                                                              #
#              option --minh ignored while using --uchime_denovo               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/98


#******************************************************************************#
#                                                                              #
#                                 Test scripts                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/99


#******************************************************************************#
#                                                                              #
#Use "|" (vertical bar) instead of ";" (semicolon) as separator in FASTA header#
#                                     lines                                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/100


#******************************************************************************#
#                                                                              #
#        Reorganize subsampling commands for compatibilty with usearch         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/101


#******************************************************************************#
#                                                                              #
#         Option to sort cluster output files by the size of clusters          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/102


#******************************************************************************#
#                                                                              #
# Option to propagate the cluster identifier to both the consensus and profile #
#                                     files                                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/103


#******************************************************************************#
#                                                                              #
#                     Missing output in uchime_denovo mode                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/104


#******************************************************************************#
#                                                                              #
#                                Change license                                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/105


#******************************************************************************#
#                                                                              #
#                  Replace CityHash by FarmHash or MetroHash?                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/106


#******************************************************************************#
#                                                                              #
#                     Add header information to sam output                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/107


#******************************************************************************#
#                                                                              #
#                        Warnings reported by cppcheck                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/108


#******************************************************************************#
#                                                                              #
#                  Request regarding abundance labeled output                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/109


#******************************************************************************#
#                                                                              #
#                            details of msa output                             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/110


#******************************************************************************#
#                                                                              #
#                Large memory consumption with --fastx_revcomp                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/111


#******************************************************************************#
#                                                                              #
#                                     Typo                                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/112


#******************************************************************************#
#                                                                              #
#                                 Help message                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/113


#******************************************************************************#
#                                                                              #
#              Remove stray ` mark from installation instructions              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/114


#******************************************************************************#
#                                                                              #
#                         Support xz compressed files                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/115


#******************************************************************************#
#                                                                              #
#                           FASTQ version conversion                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/116


#******************************************************************************#
#                                                                              #
#                         Add "-v" option for version                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/117


#******************************************************************************#
#                                                                              #
#                          Improve chimera detection                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/118


#******************************************************************************#
#                                                                              #
#                                 Support AVX2                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/119


#******************************************************************************#
#                                                                              #
#      Make --fastx_subsample work with FASTQ files, not just FASTA files      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/120


#******************************************************************************#
#                                                                              #
#                      Add relabelling options to shuffle                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/121


#******************************************************************************#
#                                                                              #
#                               sizeorder option                               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/122


#******************************************************************************#
#                                                                              #
#                       Issue with zlib on version 1.4.0                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/123


#******************************************************************************#
#                                                                              #
#                    Remove dependency on crypto libraries                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/124


#******************************************************************************#
#                                                                              #
#                           Fix example in man page                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/125


#******************************************************************************#
#                                                                              #
#                    realloc() error clustering on v.1.4.1                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/126


#******************************************************************************#
#                                                                              #
#     Fatal error: Cannot determine amount of RAM with 1.4.2 on OSX 10.8.5     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/127


#******************************************************************************#
#                                                                              #
#                Fix alignment bug introduced in version 1.2.17                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/128


#******************************************************************************#
#                                                                              #
#              possible for .uc files to be relabel_sha1-aware?                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/129


#******************************************************************************#
#                                                                              #
#                              add --search_exact                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/130


#******************************************************************************#
#                                                                              #
#                    add --relabel option to --shuffle #121                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/131


#******************************************************************************#
#                                                                              #
#                     Implement the search_global command                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/132


#******************************************************************************#
#                                                                              #
#                         Add test for --search_exact                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/133


#******************************************************************************#
#                                                                              #
#                         release vsearch on anacoda?                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/134


#******************************************************************************#
#                                                                              #
#                   error in --fastq_stats on MaxOSX 10.8.5                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/135


#******************************************************************************#
#                                                                              #
#            Allow floating point number argument to threads option            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/136


#******************************************************************************#
#                                                                              #
#                           disable default CXXFLAGS                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/137


#******************************************************************************#
#                                                                              #
#             fastq_convert: fastaout does not work on fastq files             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/138


#******************************************************************************#
#                                                                              #
#                   Remove autoconf files from distribution                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/139


#******************************************************************************#
#                                                                              #
#             escape tabs in fasta names writing output with --uc              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/140

## vsearch truncates at the first space or tab by default, similar to
## usearch. If the --notrunclabels option is specified, the entire
## line will be read.

## vsearch truncates after a tab
DESCRIPTION="truncate headers after a tab (issue 141)"
"${VSEARCH}" \
    --cluster_fast <(printf ">s1\theader\nA\n") \
    --id 0.97 \
    --quiet \
    --minseqlength 1 \
    --uc - | \
    awk -F "\t" '{exit /^S/ && $9 == "s1" && $10 == "*" ? 0 : 1}' && \
    success  "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"

## vsearch does not truncate after a tab with --notrunclabels
DESCRIPTION="do not truncate after a tab with --notrunclabels (issue 141)"
"${VSEARCH}" \
    --cluster_fast <(printf ">s1\theader\nA\n") \
    --id 0.97 \
    --quiet \
    --notrunclabels \
    --minseqlength 1 \
    --uc - | \
    awk -F "\t" '{exit /^S/ && $9 == "s1" && $10 == "header" ? 0 : 1}' && \
    success  "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#                   quote fasta record names in --uc output                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/141


#******************************************************************************#
#                                                                              #
#    Segfault or fatal error with fastx-commands on compressed input files     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/142


#******************************************************************************#
#                                                                              #
#                          Improved chimera reporting                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/143


#******************************************************************************#
#                                                                              #
#    Optionally compress output to FASTA or FASTQ files with gzip or bzip2     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/144


#******************************************************************************#
#                                                                              #
#vsearch --fastq_stats doesn't report correct values of AvgEE, Rate and RatePct#
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/145


#******************************************************************************#
#                                                                              #
#         Error in installing vsearch 1.9.2 from source on OS X 10.8.5         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/146


#******************************************************************************#
#                                                                              #
#                          Letter case not preserved                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/147


#******************************************************************************#
#                                                                              #
#                         Add --fastq_eestats command                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/148


#******************************************************************************#
#                                                                              #
#                   Incorrect abundance in subsample output                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/149


#******************************************************************************#
#                                                                              #
#                   relabel issue duruing --derep_fulllength                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/150


#******************************************************************************#
#                                                                              #
#                                Rereplication                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/151


#******************************************************************************#
#                                                                              #
#                                usearch_local                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/152


#******************************************************************************#
#                                                                              #
#                  Wrong alignment results in usearch_global                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/153


#******************************************************************************#
#                                                                              #
#                                automake 1.15                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/154


#******************************************************************************#
#                                                                              #
#                     Request: uchime score in fasta label                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/155


#******************************************************************************#
#                                                                              #
#             Avoid progress indicator if stderr is not a terminal             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/156
# Avoid updating the progress indicator when stderr is not a terminal

# In practice, stderr is not a tty when --log is used and is a
# file. Maybe the issue should be renamed "Avoid writing progress
# indicator to log file"?

DESCRIPTION="do not output progress when stderr is a tty and stdout is a tty"
"${VSEARCH}" \
    --fastx_mask <(printf ">seq1\nACGT\n") \
    --fastaout - 2>&1 | \
    grep -q "Writing output" && \
    failure "${DESCRIPTION}" || \
        success  "${DESCRIPTION}"  # should we avoid visually mixed output?

DESCRIPTION="output progress when stderr is a redirection and stdout is a tty"
"${VSEARCH}" \
    --fastx_mask <(printf ">seq1\nACGT\n") \
    --fastaout - 2>&1 | \
    grep -q "Writing output" && \
    success  "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"

DESCRIPTION="output progress when log, stderr and stdout are ttys"
"${VSEARCH}" \
    --fastx_mask <(printf ">seq1\nACGT\n") \
    --log - \
    --fastaout - 2>&1 | \
    grep -q "Writing output" && \
    success  "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"

DESCRIPTION="do not output progress when stderr is a redirection"
"${VSEARCH}" \
    --fastx_mask <(printf ">seq1\nACGT\n") \
    --fastaout /dev/null 2>&1 | \
    grep -q "Writing output" && \
    failure "${DESCRIPTION}" || \
        success  "${DESCRIPTION}"  # can vsearch know if stderr is
                                   # attached to anything else than a
                                   # tty?

DESCRIPTION="do not output progress when log is a file and stderr is a redirection"
PROGRESS=$(mktemp)
"${VSEARCH}" \
    --fastx_mask <(printf ">seq1\nACGT\n") \
    --log ${PROGRESS} \
    --fastaout - > /dev/null 2>> ${PROGRESS}
grep -q "Writing output" ${PROGRESS} && \
    failure "${DESCRIPTION}" || \
        success  "${DESCRIPTION}"
rm ${PROGRESS}

DESCRIPTION="do not output progress when log is a process substitution"
"${VSEARCH}" \
    --fastx_mask <(printf ">seq1\nACGT\n") \
    --log >(grep -q "Writing output" && true) \
    --fastaout - 2>&1 | \
    grep -q "Writing output" && \
    failure "${DESCRIPTION}" || \
        success  "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#                      Segmentation fault with uchime_ref                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/157


#******************************************************************************#
#                                                                              #
#         Database sequences in lower case are being masked by default         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/158


#******************************************************************************#
#                                                                              #
#            Remove unaligned part of alignment in uchimealn files             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/159


#******************************************************************************#
#                                                                              #
#                     --relabel not working with --consout                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/160


#******************************************************************************#
#                                                                              #
#           Add options to filter sequences and consensus sequences            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/161


#******************************************************************************#
#                                                                              #
#                       inconsistency with merging pairs                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/162


#******************************************************************************#
#                                                                              #
#                              --self doco error?                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/163


#******************************************************************************#
#                                                                              #
#             Do not truncate FASTQ labels (for fastq_mergepairs)              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/164


#******************************************************************************#
#                                                                              #
#                     New option to output sequence length                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/165


#******************************************************************************#
#                                                                              #
#                               Make OTU tables                                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/166


#******************************************************************************#
#                                                                              #
#   Add idoffset argument for clustering of non-overlapped paired-end reads    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/167


#******************************************************************************#
#                                                                              #
#                  Output expected errors to fasta format too                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/168


#******************************************************************************#
#                                                                              #
#                         Compilation error [Fasta.c]                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/169


#******************************************************************************#
#                                                                              #
#                          Windows Executable Version                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/170


#*****************************************************************************#
#                                                                             #
#               Segmentation fault with empty query (issue 171)               #
#                                                                             #
#*****************************************************************************#

DESCRIPTION="no segmentation fault when a query is empty (issue 171)"
"${VSEARCH}" \
    --usearch_global <(printf ">seq1\n\n") \
    -db <(printf ">ref1\nACGT\n") \
    --id 0.97 \
    --quiet \
    --alnout - &> /dev/null && \
    success "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#        Windows Modifications For Compilation with Visual Studio 2015         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/172


#******************************************************************************#
#                                                                              #
#            Indicate matching strand in uc file when dereplicating            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/173


#******************************************************************************#
#                                                                              #
#       Improve error message when FASTQ quality values are out of range       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/174


#******************************************************************************#
#                                                                              #
#               Merge pair fails when there are empty sequences                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/175


#******************************************************************************#
#                                                                              #
#       Compute evalues and bit scores using Karlin-Altschul statistics        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/176


#******************************************************************************#
#                                                                              #
#                       uchime_denovo on very long reads                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/177


#******************************************************************************#
#                                                                              #
#  cluster_smallmem: "Unable to allocate enough memory" error on a very large  #
#                                    dataset                                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/178


#******************************************************************************#
#                                                                              #
#                     Wrong values in the blast6out table                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/179


#******************************************************************************#
#                                                                              #
#             New option for trimming the sequence based on maxEE              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/180


#*****************************************************************************#
#                                                                             #
#     N-tails are converted to A-tails in consensus sequences (issue 181)     #
#                                                                             #
#*****************************************************************************#

# DESCRIPTION="N-tails are preserved in consensus sequences (issue 181)"
# "${VSEARCH}" \
#   --cluster_fast <(printf ">s1\nACGTNNN\n>s2\nACGT\n") \
#   --id 0.50 \
#   --minseqlength 1 \
#   --fasta_width 0 \
#   --quiet \
#   --consout - | \
#     grep -qE "N{3}$" && \
#     success "${DESCRIPTION}" || \
#         failure "${DESCRIPTION}"


#*****************************************************************************#
#                                                                             #
#                --query_cov and --userfield qcov (issue 182)                 #
#                                                                             #
#*****************************************************************************#

# DESCRIPTION="query coverage filtering works (issue 182)"
# QUERY=$(mktemp)
# DATABASE=$(mktemp)
# NOTMATCHED=$(mktemp)
# USEROUT=$(mktemp)
# ALN=$(mktemp)
# COVERAGE="0.90"
# cat > ${QUERY} <<'EOT'
# >query
# CTGGCTCAGG
# EOT

# cat > ${DATABASE} <<'EOT'
# >target
# CTGGCTCAGG
# EOT

# "${VSEARCH}" \
#     --usearch_global ${QUERY} \
#     --db ${DATABASE} \
#     --notmatched ${NOTMATCHED} \
#     --userout ${USEROUT} \
#     --query_cov ${COVERAGE} \
#     --alnout ${ALN} \
#     --id 0.7 \
#     --minseqlength 1 \
#     --rowlen 80 \
#     --output_no_hits \
#     --userfields query+target+id+qcov > /dev/null 2> /dev/null

# ## query_cov: (matches + mismatches) / query sequence length. Internal or terminal gaps are not taken into account.

# echo "userout"
# [[ -s ${USEROUT} ]] && cat ${USEROUT}
# echo "not matched"
# [[ -s ${NOTMATCHED} ]] && cat ${NOTMATCHED}
# echo "alignment"
# [[ -s ${ALN} ]] && cat ${ALN}

# ## Clean
# rm "${QUERY}" "${ALN}" "${NOTMATCHED}" "${USEROUT}" "${DATABASE}"


#******************************************************************************#
#                                                                              #
#           Comparing vsearch chimera detection with uchime - denovo           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/183


#******************************************************************************#
#                                                                              #
#             Segmentation fault when masking very long sequences              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/184


#******************************************************************************#
#                                                                              #
#                            Implement cluster_otus                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/185


#******************************************************************************#
#                                                                              #
#     --minseqlength and --maxseqlength options do not work for filtering      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/186


#******************************************************************************#
#                                                                              #
#                             Illegal instruction                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/187


#******************************************************************************#
#                                                                              #
#                            Rolling hash function?                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/188


#******************************************************************************#
#                                                                              #
#                          Allow shorter word lengths                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/189


#******************************************************************************#
#                                                                              #
#                  Filtering options for fastA sequences also                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/190


#******************************************************************************#
#                                                                              #
#                              typo in the manual                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/191


#******************************************************************************#
#                                                                              #
#            Improve documentation of fastq_stats and fastq_eestats            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/192


#******************************************************************************#
#                                                                              #
#         Add option to write non-chosen subsamples to a separate file         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/193


#******************************************************************************#
#                                                                              #
#          --fastq_stats fails on fastq files with an offset of +64?           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/194


#******************************************************************************#
#                                                                              #
#                         redundancy in read searching                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/195


#******************************************************************************#
#                                                                              #
#                    Document the UC format in the manpage                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/196


#******************************************************************************#
#                                                                              #
#               Extend --fastx_subsample to support FASTQ files                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/197


#******************************************************************************#
#                                                                              #
#                              Update the manpage                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/198


#******************************************************************************#
#                                                                              #
#       --top_hits_only limited to --matched instead of also --dbmatched       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/199


#******************************************************************************#
#                                                                              #
#                                fulldp option                                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/200


#******************************************************************************#
#                                                                              #
#  Missing H record in --uc output when prefix dereplicating two sequences of  #
#                                unequal length                                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/201


#******************************************************************************#
#                                                                              #
#                             Implement relabel @                              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/202


#*****************************************************************************#
#                                                                             #
#         fastq_trunclen and discarded short sequences (issue 203)            #
#                                                                             #
#*****************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/203

DESCRIPTION="discard entries shorter than --fastq_trunclength value (issue 203)"
"${VSEARCH}" \
    --fastq_filter <(printf "@seq1\nACGT\n+\nIIII\n") \
    --fastq_trunclen 5 \
    --quiet \
    --fastqout - \
    2> /dev/null | \
    grep -q "seq1" && \
    failure "${DESCRIPTION}" || \
        success  "${DESCRIPTION}"

DESCRIPTION="keep entries equal or longer than --fastq_trunclength value (issue 203)"
"${VSEARCH}" \
    --fastq_filter <(printf "@seq1\nACGT\n+\nIIII\n") \
    --fastq_trunclen 4 \
    --quiet \
    --fastqout - \
    2> /dev/null | \
    grep -q "seq1" && \
    success  "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#        fastx_filter ignores input sequence abundance when relabeling         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/204
#
# --fastx_filter ignores input sequence abundances when relabeling
# with fasta input, --sizein and --sizeout options
DESCRIPTION="fastx_filter reports sizein when relabeling fasta (issue 204)"
"${VSEARCH}" \
    --fastx_filter <(printf ">seq1;size=5;\nACGT\n") \
    --sizein \
    --relabel_md5 \
    --sizeout \
    --quiet \
    --fastaout - \
    2> /dev/null | \
    grep -q ";size=5;" && \
    success  "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#                            Old versions on conda                             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/205


#******************************************************************************#
#                                                                              #
#                       Fatal error when reading ncbi-nr                       #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/206


#******************************************************************************#
#                                                                              #
#            Use cluster number in column 2 on H-lines in uc files             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/207


#******************************************************************************#
#                                                                              #
#                       dereplication option suggestion                        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/208


#******************************************************************************#
#                                                                              #
#                         An error when running v2.30                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/209


#******************************************************************************#
#                                                                              #
#                          Sintax taxonomy classifier                          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/210


#******************************************************************************#
#                                                                              #
#                   gapopen and gapext - effect as expected?                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/211


#******************************************************************************#
#                                                                              #
#   FORBIDDEN INTERNAL GAPS and MISSING OF CLUSTERING FOR SEQUENCES WITH THE   #
#                                  LENGTH > 7                                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/212


#******************************************************************************#
#                                                                              #
# Internal gaps occur in alignments even with infinite internal gap penalties  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/213


#******************************************************************************#
#                                                                              #
#                 Improve behaviour with very short sequences                  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/214


#******************************************************************************#
#                                                                              #
#                   --top_hits_only reports only one top hit                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/215


#******************************************************************************#
#                                                                              #
#  Use "=" in column 8 of uc files with perfect alignment also when ignoring   #
#                                 terminal gaps                                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/216


#******************************************************************************#
#                                                                              #
#             Ideas for potential improvement in accuracy or speed             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/217


#******************************************************************************#
#                                                                              #
#                     Improve multiple sequence alignment                      #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/218


#******************************************************************************#
#                                                                              #
#            Describe a standard metabarcoding pipeline for vsearch            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/219


#******************************************************************************#
#                                                                              #
#                    clustering: profiles do not make sense                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/220


#******************************************************************************#
#                                                                              #
#  Output file for --fastq_eestats specified with --output option, not --log   #
#                                    option                                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/221


#******************************************************************************#
#                                                                              #
#                   Port VSEARCH to the POWER8 architecture                    #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/222


#******************************************************************************#
#                                                                              #
#                         Correctly detect named pipes                         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/223


#******************************************************************************#
#                                                                              #
#                     Qiime open reference does not work ?                     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/224


#******************************************************************************#
#                                                                              #
#        Add minuniquesize/maxuniquesize to the command --fastx_filter         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/225


#******************************************************************************#
#                                                                              #
#                            fastq_eestats2 feature                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/226


#******************************************************************************#
#                                                                              #
#             Truncate header when converting from FASTQ to FASTA              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/227


#******************************************************************************#
#                                                                              #
#                Overflow in fastq_stats with large FASTQ files                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/228


#******************************************************************************#
#                                                                              #
#                 Compatibility with older versions of usearch                 #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/229


#******************************************************************************#
#                                                                              #
#  Using Vsearch to produce a consensus OTU table from non-overlapping reads   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/230


#******************************************************************************#
#                                                                              #
#         Add fastq_maxdiffpct option (% difference for merging pairs)         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/231


#******************************************************************************#
#                                                                              #
#        Recording query reads that fail to cluster as "N" or "No hit"         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/232


#******************************************************************************#
#                                                                              #
#               Progress bar during shuffling always shows 100%                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/233


#******************************************************************************#
#                                                                              #
#                          Add support for udb files                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/234


#******************************************************************************#
#                                                                              #
#         Can we have a function of write to standard output and error         #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/235


#******************************************************************************#
#                                                                              #
#                        OTU sequence short than before                        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/236


#******************************************************************************#
#                                                                              #
#              should --log capture the output of --fastq_chars?               #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/237


#******************************************************************************#
#                                                                              #
# when in doubt, --fastq_chars should assume an offset of +33 rather than +64  #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/238


#******************************************************************************#
#                                                                              #
#                   shuffle silently converts fastq to fasta                   #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/239


#******************************************************************************#
#                                                                              #
#                           Typo in warning message                            #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/240


#******************************************************************************#
#                                                                              #
#       what should average cluster size be when there are no clusters?        #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/241


#******************************************************************************#
#                                                                              #
#                           Add --relabel_ids option                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/242


#******************************************************************************#
#                                                                              #
#                           Dealing with a full disk                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/243


#******************************************************************************#
#                                                                              #
#                          Lifting memory limitation                           #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/244


#******************************************************************************#
#                                                                              #
#         query end position correct in blast6 output when Searching?          #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/245


#******************************************************************************#
#                                                                              #
#                            link broken in README                             #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/246


#******************************************************************************#
#                                                                              #
#                fix link to manpage in README.md to close #246                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/pull/247


#******************************************************************************#
#                                                                              #
#      fastx_subsample: wrong error message when omiting --sample_pct or       #
#                                 --sample_size                                #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/248


#******************************************************************************#
#                                                                              #
#             change the warning message for discarded sequences?              #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/249


#******************************************************************************#
#                                                                              #
#     vsearch help or version should return the latest vsearch publication     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/250


#******************************************************************************#
#                                                                              #
#   For the fastq_eestats2 option the argument "-" is not treated as stdin     #
#                                                                              #
#******************************************************************************#
## 
## https://github.com/torognes/vsearch/issues/273

DESCRIPTION="fastq_eestats2 treats \"-\" as stdin (issue 273)"
printf "@s1\nA\n+\nI\n" | \
    "${VSEARCH}" --fastq_eestats2 - --output - &> /dev/null && \
    success "${DESCRIPTION}" || \
        failure "${DESCRIPTION}"


#******************************************************************************#
#                                                                              #
#                      utax reference dataset vsearch                          #
#                                                                              #
#******************************************************************************#
##
## https://github.com/torognes/vsearch/issues/274

## this is a question, not a bug


#******************************************************************************#
#                                                                              #
#                    Compilation warnings with GCC 8.0                         #
#                                                                              #
#******************************************************************************#
##
## https://github.com/torognes/vsearch/issues/304


exit 0
